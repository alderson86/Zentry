<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registro de Funcionários</title>
  <style>
    :root {
      --bg: #f9f9fa;
      --card: #ffffff;
      --text: #2c2c2e;
      --accent: #007aff;
      --border: #d2d2d6;
      --header-bg: #f2f2f7;
    }
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen;
      margin: 0;
      padding: 0;
      background-color: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    #tabela-container {
      flex: 1;
      padding: 16px;
      height: 80%;
      overflow-y: auto;
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      background-color: var(--card);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      table-layout: fixed;
    }
    thead th, tbody td {
      text-align: left;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    thead th {
      position: sticky;
      top: 0;
      background-color: var(--header-bg);
      z-index: 1;
      font-weight: 600;
      border-bottom: 1px solid var(--border);
      padding: 12px;
    }
    tbody td {
      padding: 12px;
      border-bottom: 1px solid var(--border);
    }
    #formulario {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      padding: 12px;
      background-color: var(--card);
      border-top: 1px solid var(--border);
      box-shadow: 0 -1px 4px rgba(0,0,0,0.05);
    }
    #formulario input, #formulario select {
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid var(--border);
      flex: 1;
      font-family: inherit;
    }
    #formulario button {
      padding: 10px 16px;
      font-size: 15px;
      border: none;
      border-radius: 10px;
      background-color: var(--accent);
      color: white;
      cursor: pointer;
      transition: background-color 0.2s ease;
      font-family: inherit;
    }
    #formulario button:hover {
      background-color: #005fcc;
    }
  </style>
</head>
<body>
  <div id="tabela-container">
    <table id="tabela-registros">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Placa</th>
          <th>Hora Entrada</th>
          <th>Hora Saída</th>
          <th>Obs.</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="formulario">
    <select id="nome">
      <option disabled selected>Selecione o nome</option>
      <option>Oscar - Supervisor</option>
      <option>João Paulo - Menor Aprendiz</option>
      <option>Thalles</option>
      <option>André</option>
      <option>Ezequias</option>
      <option>Luiz Carlos</option>
      <option>João Vitor</option>
      <option>Luiz Henrique</option>
      <option>Gean Carlos</option>
      <option>Raimundo</option>
      <option>Michel F. - Menor Aprendiz</option>
      <option>Vitória Isabele</option>
      <option>Cristiano</option>
      <option>Marsergio - Gerente</option>
      <option>André - ADM</option>
      <option>Enildo - Supervisor</option>
      <option>Thiago Benjamin</option>
      <option>Edirlei - CPD</option>
      <option>Yuri - Menor Aprendiz</option>
      <option>Pedro H - Menor Aprendiz</option>
      <option>Felipe - Menor Aprendiz</option>
      <option>Jayme - Encarregado</option>
      <option>Raimundo - Van</option>
      <option>Marcos - Van</option>
      <option>Fábio - Van</option>
      <option>Eriton - Van</option>
      <option>Elionai - Van</option>
      <option>Edmar - Van</option>
      <option>Jefferson - Van</option>
      <option>Gabriel - Menor Aprendiz</option>
      <option>Dangel – Menor aprendiz</option>
      <option>Cauan – Menor aprendiz</option>
      <option>Nicolas G – Menor aprendiz</option>
      <option>Elias – Menor aprendiz</option>
      <option>Abraão - Menor Aprendiz</option>
      <option>Wanderson</option>
      <option>Keverson</option>
      <option>Leandro F.</option>
      <option>Murilo - Menor Aprendiz</option>
      <option>Matias - Menor Aprendiz</option>
      <option>Leandro P.</option>
    </select>
    <input type="text" id="placa" placeholder="Placa" />
    <input type="time" id="entrada" />
    <input type="time" id="saida" />
    <input type="text" id="obs" placeholder="Observação" />
    <button onclick="salvarRegistro()">Salvar</button>
    <button onclick="editarRegistro()">Editar</button>
    <button onclick="exportarTXT()">Emitir TXT</button>
    <button onclick="exportarExcel()">Emitir Excel</button>
  </div>

  <script>
    const STORAGE_KEY = 'registro_funcionarios_skairipa';
    let editIndex = null;

    function salvarRegistro() {
      const nome = document.getElementById('nome').value;
      const placa = document.getElementById('placa').value;
      const entrada = document.getElementById('entrada').value;
      const saida = document.getElementById('saida').value;
      const obs = document.getElementById('obs').value;
      const registros = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

      if (editIndex !== null) {
        registros[editIndex] = { nome, placa, entrada, saida, obs };
        editIndex = null;
      } else {
        registros.push({ nome, placa, entrada, saida, obs });
      }

      localStorage.setItem(STORAGE_KEY, JSON.stringify(registros));
      limparFormulario();
      carregarRegistros();
    }

    function editarRegistro() {
      if (editIndex === null) return alert('Selecione uma linha com duplo clique.');
      salvarRegistro();
    }

    function excluirRegistro(index) {
      if (!confirm('Deseja realmente excluir este registro?')) return;
      const registros = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
      registros.splice(index, 1);
      localStorage.setItem(STORAGE_KEY, JSON.stringify(registros));
      carregarRegistros();
    }

    function exportarTXT() {
      const registros = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
      const texto = registros.map(r => `${r.nome}\t${r.placa}\t${r.entrada}\t${r.saida}\t${r.obs}`).join('\n');
      const blob = new Blob([texto], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'registros.txt';
      a.click();
    }

    function exportarExcel() {
      const registros = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
      let csv = 'Nome,Placa,Entrada,Saída,Observação\n';
      registros.forEach(r => {
        csv += `${r.nome},${r.placa},${r.entrada},${r.saida},${r.obs}\n`;
      });
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'registros.csv';
      a.click();
    }

    function carregarRegistros() {
      const tbody = document.querySelector('#tabela-registros tbody');
      tbody.innerHTML = '';
      const registros = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
      registros.forEach((r, index) => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${r.nome}</td>
          <td>${r.placa}</td>
          <td>${r.entrada}</td>
          <td>${r.saida}</td>
          <td>${r.obs}</td>
          <td><button onclick="excluirRegistro(${index})">Del</button></td>
        `;
        row.ondblclick = () => {
          document.getElementById('nome').value = r.nome;
          document.getElementById('placa').value = r.placa;
          document.getElementById('entrada').value = r.entrada;
          document.getElementById('saida').value = r.saida;
          document.getElementById('obs').value = r.obs;
          editIndex = index;
        };
      });
    }

    function limparFormulario() {
      document.getElementById('nome').value = '';
      document.getElementById('placa').value = '';
      document.getElementById('entrada').value = '';
      document.getElementById('saida').value = '';
      document.getElementById('obs').value = '';
    }

    window.onload = carregarRegistros;
  </script>
</body>
</html>
